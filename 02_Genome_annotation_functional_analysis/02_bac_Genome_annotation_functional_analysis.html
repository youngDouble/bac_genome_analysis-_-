<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>02_bac_Genome_annotation_functional_analysis.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.clearness{padding:20px;color:#737373;font-size:15px;background:#fff;-webkit-font-smoothing:antialiased}.clearness a{color:#1e6ea7}.clearness a:hover{color:#268bd2}.clearness h1,.clearness h2,.clearness h3,.clearness h4,.clearness h5{color:#404040}.clearness h2{border-bottom:1px solid #ccc;line-height:1.7em}.clearness h6{color:#666}.clearness hr{border:1px solid #e6e6e6}.clearness pre>code{font-size:.9em}.clearness blockquote{padding:0 15px;font-style:italic}.clearness blockquote:before{content:"\201C";font-size:40px;margin-left:-20px;color:#aaa}.clearness table{background-color:#fff;border-collapse:separate;border-spacing:2px}.clearness table tr td,.clearness table tr th{border:0;padding:.2em 1em}.clearness table tr th{border-bottom:1px solid #bfbfbf}.clearness table tr td{border-bottom:1px solid #d9d9d9}.clearness table tr:nth-child(2n){background-color:#fff}.hljs{display:block;overflow-x:auto;padding:.5em;background:#eaeef3;-webkit-text-size-adjust:none}.hljs,.hljs-list .hljs-built_in{color:#00193a}.hljs-header,.hljs-important,.hljs-javadoctag,.hljs-keyword,.hljs-request,.hljs-title{font-weight:700}.hljs-chunk,.hljs-comment{color:#738191}.hljs-addition,.hljs-argument,.hljs-blockquote,.hljs-built_in,.hljs-filename,.hljs-header,.hljs-link_label,.hljs-literal,.hljs-parent,.hljs-string,.hljs-tag,.hljs-title,.hljs-value{color:#0048ab}.hljs-attr_selector,.hljs-attribute,.hljs-bullet,.hljs-decorator,.hljs-deletion,.hljs-doctype,.hljs-javadoc,.hljs-link_url,.hljs-phony,.hljs-pi,.hljs-pragma,.hljs-preprocessor,.hljs-prompt,.hljs-regexp,.hljs-shebang,.hljs-sqbracket,.hljs-string .hljs-variable,.hljs-subst,.hljs-symbol,.hljs-xmlDocTag,.hljs-yardoctag{color:#4c81c9}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:2px;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:2px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:1em}.MathJax_MenuRadioCheck.RTL{right:1em;left:auto}.MathJax_MenuLabel{padding:2px 2em 4px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #CCC;margin:4px 1px 0}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:Highlight;color:HighlightText}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown clearness">
<font color="black" size="7"><center><strong>基因组注释及功能分析</strong></center></font><font color="black"><center>Author: YangZS</center></font><font color="black"><center>Date: October 9, 2020</center></font><h1 id="目录"><a name="目录" href="#目录"></a>目录</h1><p class="toc" style="undefined"></p><ul>
<li><ul>
<li><span class="title">
<a href="#1.分析环境搭建" title="1.分析环境搭建">1.分析环境搭建</a>
</span>
<!--span class="number">
0
</span-->
<ul>
<li><span class="title">
<a href="#1.1-conda下载" title="1.1 conda下载">1.1 conda下载</a>
</span>
<!--span class="number">
1
</span-->
</li>
<li><span class="title">
<a href="#1.2-conda安装" title="1.2 conda安装">1.2 conda安装</a>
</span>
<!--span class="number">
2
</span-->
</li>
<li><span class="title">
<a href="#1.3-conda配置国内镜像" title="1.3 conda配置国内镜像">1.3 conda配置国内镜像</a>
</span>
<!--span class="number">
3
</span-->
</li>
<li><span class="title">
<a href="#1.4-conda-的简单使用" title="1.4 conda 的简单使用">1.4 conda 的简单使用</a>
</span>
<!--span class="number">
4
</span-->
</li>
<li><span class="title">
<a href="#1.5-创建一个生信分析环境" title="1.5 创建一个生信分析环境">1.5 创建一个生信分析环境</a>
</span>
<!--span class="number">
5
</span-->
<ul>
<li><span class="title">
<a href="#1.5.1-测试安装软件" title="1.5.1 测试安装软件">1.5.1 测试安装软件</a>
</span>
<!--span class="number">
6
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#2-安装基因组注释及功能分析的相关软件" title="2 安装基因组注释及功能分析的相关软件">2 安装基因组注释及功能分析的相关软件</a>
</span>
<!--span class="number">
7
</span-->
<ul>
<li><span class="title">
<a href="#2.1-基因组组装" title="2.1 基因组组装">2.1 基因组组装</a>
</span>
<!--span class="number">
8
</span-->
</li>
<li><span class="title">
<a href="#2.2-基因组注释" title="2.2 基因组注释">2.2 基因组注释</a>
</span>
<!--span class="number">
9
</span-->
<ul>
<li><span class="title">
<a href="#**ncbi_pgap注释流程**:" title="NCBI_PGAP注释流程:">NCBI_PGAP注释流程:</a>
</span>
<!--span class="number">
10
</span-->
</li>
<li><span class="title">
<a href="#**patric在线注释系统**：" title="PATRIC在线注释系统：">PATRIC在线注释系统：</a>
</span>
<!--span class="number">
11
</span-->
</li>
<li><span class="title">
<a href="#**genix-在线注释**：" title="Genix 在线注释：">Genix 在线注释：</a>
</span>
<!--span class="number">
12
</span-->
</li>
<li><span class="title">
<a href="#本地注释工具" title="本地注释工具">本地注释工具</a>
</span>
<!--span class="number">
13
</span-->
<ul>
<li><span class="title">
<a href="#prokka" title="prokka">prokka</a>
</span>
<!--span class="number">
14
</span-->
<ul>
<li><span class="title">
<a href="#**-prokka-安装使用**" title=" prokka 安装使用"> prokka 安装使用</a>
</span>
<!--span class="number">
15
</span-->
</li>
<li><span class="title">
<a href="#**一个prokka基因组注释实例**" title="一个prokka基因组注释实例">一个prokka基因组注释实例</a>
</span>
<!--span class="number">
16
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#使用eggnog-mapper进行功能注释" title="使用eggnog-mapper进行功能注释">使用eggnog-mapper进行功能注释</a>
</span>
<!--span class="number">
17
</span-->
<ul>
<li><span class="title">
<a href="#eggnog-mapper安装" title="eggnog-mapper安装">eggnog-mapper安装</a>
</span>
<!--span class="number">
18
</span-->
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>

</ul>
<p></p><h2 id="1.分析环境搭建"><a name="1.分析环境搭建" href="#1.分析环境搭建"></a>1.分析环境搭建</h2><h3 id="1.1-conda下载"><a name="1.1-conda下载" href="#1.1-conda下载"></a>1.1 conda下载</h3><p>   <strong>conda</strong> 就是可以便捷获取包且对包能够进行管理，同时对环境可以统一管理的发行版本。使用conda就能满足多数的生信软件安装工作，使用conda安装管理生物信息学运行环境非常的方便 (miniconda 是anaconda的轻量级替代，Anaconda3 的功能全面，请酌情安装，使用方法都一样，miniconda有一些功能删减为避免麻烦，经我测试miniconda会出现联网问题，我这里安装anaconda3）。<br>  相比官网下载，使用国内源下载速度会快很多，这里我使用清华源下载 Anaconda3<br>  清华大学镜像：<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/</a><br>  选择版本<code>Anaconda3-5.3.0-Linux-x86_64.sh</code></p><center><img src="md_fig/anaconda_%E6%B8%85%E5%8D%8E%E6%BA%90.png" style="zoom:80%"></center><font color="black"><center>anaconda_清华源</center></font><p>下载 Anaconda3  or Miniconda3，只需要在linux命令行运行命令（<strong>下载最新版上一个版本的避免一些bug的存在</strong>）：</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-5.3.0-Linux-x86_64.sh
</code></pre>">wget https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-<span class="hljs-number">5.3</span>.<span class="hljs-number">0</span>-Linux-x86_64.sh
</code></pre><h3 id="1.2-conda安装"><a name="1.2-conda安装" href="#1.2-conda安装"></a>1.2 conda安装</h3><p>安装 Anaconda3:</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>bash Anaconda3-py38_4.8.2-Linux-x86_64.sh
#弹出提示信息，按回车（ENTER键）继续
</code></pre>">bash Anaconda3-py38_4.<span class="hljs-number">8.2</span>-Linux-x86_64.sh
<span class="hljs-comment">#弹出提示信息，按回车（ENTER键）继续</span>
</code></pre><font color="red">命令行中星号后面的行内容一般是注视信息，方便人们理解的</font><p>按空格键浏览全部证书信息，直到出现询问：<code>Do you accept the license terms? [yes|no]</code> 输入 <code>yes</code> 回车：</p><center><img src="md_fig/anaconda%E5%AE%89%E8%A3%852.png" style="zoom:80%"></center><font color="black"><center>anaconda安装同意证书信息</center></font><p>安装位置选择，使用<strong>方括号</strong>内默认的安装路径即可（直接回车 ENTER键）：</p><center><img src="md_fig/anaconda%E5%AE%89%E8%A3%853.png" style="zoom:80%"></center><font color="black"><center>anaconda安装位置</center></font><p>选择不初始化conda，需要的时候就调用就可以（<strong>直接回车选择不初始化</strong>），这里我也不建议将conda 的bin目录加入到环境变量，能够避免一些麻烦，只用conda的时候利用命令 <code>source ~/anaconda3/bin/activate</code>  激活conda环境即可</p><center><img src="md_fig/anaconda%E5%AE%89%E8%A3%854.png" style="zoom:80%"></center><font color="black"><center>初始化conda选择</center></font><h3 id="1.3-conda配置国内镜像"><a name="1.3-conda配置国内镜像" href="#1.3-conda配置国内镜像"></a>1.3 conda配置国内镜像</h3><p>   因为conda安装软件需要从镜像里下载对应的安装包，因此 anaconda 安装成功后，必须配置镜像，否则使用默认的国外线路下载，下载速度感人；这里我们使用国内的清华源的镜像，加快安装包的下载速度（只需要配置一次）。<br>这些配置信息记录在 <code>~/.condarc</code> 里，<code>cat ~/.condarc</code> 或者 <code>less ~/.condarc</code> 即可查看！</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>source ~/miniconda3/bin/activate
#source ~/anaconda3/bin/activate
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config --set show_channel_urls yes
</code></pre>"><span class="hljs-built_in">source</span> ~/miniconda3/bin/activate
<span class="hljs-comment">#source ~/anaconda3/bin/activate</span>
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda
conda config --add channels http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config --set show_channel_urls yes
</code></pre><h3 id="1.4-conda-的简单使用"><a name="1.4-conda-的简单使用" href="#1.4-conda-的简单使用"></a>1.4 conda 的简单使用</h3><p>   conda 可以创建一个虚拟环境用于安装各种软件，或分析流程，而且能够自动下载对应的依赖环境，这对于linux系统管理能力较弱的人来讲是非常友好的。一个虚拟环境就相当于一个独立的运行环境，不同环境之间不会相互影响，可以很好的管理不同版本的软件。</p><p>下面有一些基本的使用方法：</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>#创建一个环境
conda create -n 环境名称 

#查看已经建立的环境
conda info --envs

#激活基础环境
source ~/anaconda3/bin/activate
#或者source ~/anaconda3/bin/activate base

#激活特定环境 
source ~/anaconda3/bin/activate 环境名称

#退出环境
conda deactivate

#查找软件 
conda search  软件名称
#在conda网页内查找：http://bioconda.github.io/conda-recipe_index.html

#安装软件 -y 表示同意安装 否则需要手动输入 可以不加 
conda install -y  软件名1 软件名2

#安装指定版本的软件
conda install -y  samtools==1.9



#更新conda
conda update conda

#更新已安装的软件
conda update samtools

#指定channel 安装软件 
conda install -y -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda homer
</code></pre>"><span class="hljs-comment">#创建一个环境</span>
conda create -n 环境名称 

<span class="hljs-comment">#查看已经建立的环境</span>
conda info --envs

<span class="hljs-comment">#激活基础环境</span>
<span class="hljs-built_in">source</span> ~/anaconda3/bin/activate
<span class="hljs-comment">#或者source ~/anaconda3/bin/activate base</span>

<span class="hljs-comment">#激活特定环境 </span>
<span class="hljs-built_in">source</span> ~/anaconda3/bin/activate 环境名称

<span class="hljs-comment">#退出环境</span>
conda deactivate

<span class="hljs-comment">#查找软件 </span>
conda search  软件名称
<span class="hljs-comment">#在conda网页内查找：http://bioconda.github.io/conda-recipe_index.html</span>

<span class="hljs-comment">#安装软件 -y 表示同意安装 否则需要手动输入 可以不加 </span>
conda install -y  软件名<span class="hljs-number">1</span> 软件名<span class="hljs-number">2</span>

<span class="hljs-comment">#安装指定版本的软件</span>
conda install -y  samtools==<span class="hljs-number">1.9</span>



<span class="hljs-comment">#更新conda</span>
conda update conda

<span class="hljs-comment">#更新已安装的软件</span>
conda update samtools

<span class="hljs-comment">#指定channel 安装软件 </span>
conda install -y -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda homer
</code></pre><h3 id="1.5-创建一个生信分析环境"><a name="1.5-创建一个生信分析环境" href="#1.5-创建一个生信分析环境"></a>1.5 创建一个生信分析环境</h3><p>使用conda安装分析软件之前我建议创建一个单独的环境，方便后续的生信软件安装到一个环境当中，使用起来相对方便。创建环境之后，不同的环境之间的就相当于不同的容器，装的东西不会互相影响。</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>
# 创建一个小环境名为 bioinfo
conda create -n bioinfo

#激活新建立的环境 bioinfo  并安装 prokka 软件
conda activate bioinfo
conda install  -y prokka

# 以上两句话可以等同于一句命令：conda create -n bioinfo -y  prokka
</code></pre>">
<span class="hljs-comment"># 创建一个小环境名为 bioinfo</span>
conda create -n bioinfo

<span class="hljs-comment">#激活新建立的环境 bioinfo  并安装 prokka 软件</span>
conda activate bioinfo
conda install  -y prokka

<span class="hljs-comment"># 以上两句话可以等同于一句命令：conda create -n bioinfo -y  prokka</span>
</code></pre><center><img src="md_fig/conda%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E7%8E%AF%E5%A2%83.png" style="zoom:80%"></center><font color="black"><center>conda创建一个新环境</center></font><center><img src="md_fig/conda_bioinfo_%E5%AE%89%E8%A3%85prokka.png" style="zoom:50%"></center><font color="black"><center>conda<em>bioinfo</em>安装prokka</center></font><center><img src="md_fig/conda_bioinfo_%E5%AE%89%E8%A3%85prokka%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E6%89%A7%E8%A1%8C%E5%AE%89%E8%A3%85.png" style="zoom:80%"></center><font color="black"><center>conda<em>bioinfo</em>安装prokka下载文件执行安装</center></font><h4 id="1.5.1-测试安装软件"><a name="1.5.1-测试安装软件" href="#1.5.1-测试安装软件"></a>1.5.1 测试安装软件</h4><p>     安装完成后再该环境内运行刚才安装的软件测试安装是否成功，命令行运行：</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>prokka -h
#出现帮助信息则安装成功
</code></pre>">prokka -h
<span class="hljs-comment">#出现帮助信息则安装成功</span>
</code></pre><center><img src="md_fig/prokka%E6%B5%8B%E8%AF%95%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF.png" style="zoom:80%"></center><font color="black"><center>prokka测试帮助信息</center></font><h2 id="2-安装基因组注释及功能分析的相关软件"><a name="2-安装基因组注释及功能分析的相关软件" href="#2-安装基因组注释及功能分析的相关软件"></a>2 安装基因组注释及功能分析的相关软件</h2><h3 id="2.1-基因组组装"><a name="2.1-基因组组装" href="#2.1-基因组组装"></a>2.1 基因组组装</h3><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>#安装细菌二代基因组测序数据质控及组装软件
conda install  -y  fastp spades
</code></pre>"><span class="hljs-comment">#安装细菌二代基因组测序数据质控及组装软件</span>
conda install  -y  fastp spades
</code></pre><center><img src="md_fig/%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%B5%8B%E5%BA%8F%E8%B4%A8%E6%8E%A7%E7%BB%84%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6.png" style="zoom:80%"></center><font color="black"><center>下载安装基因组测序质控组装的软件</center></font><h3 id="2.2-基因组注释"><a name="2.2-基因组注释" href="#2.2-基因组注释"></a>2.2 基因组注释</h3><p>   <strong>基因组注释</strong>（<strong>Genome annotation</strong>）是利用生物信息学方法和工具，对基因组所有基因和其他结构进行高通量注释。<br>   基因组注释主要包括：基因组组成成分分析（重复序列的识别、非编码基因预测、编码基因预测）和基因的功能注释，前者属于结构性注释，尤其是编码基因的预测十分重要。</p><p>   目前存在一些在线的基因组注释流程，可以用于微生物基因组注释，例如NCBI基因组提交过程中可选的注释流程（<strong>不可随意使用</strong>）；用于注释细菌和古细菌基因组的RAST网络服务器；整合多种数据资源的 PATRIC 和genix 细菌基因组在线自动化注释流程等。都可以进行细菌基因组的注释工作。</p><h4 id="**ncbi_pgap注释流程**:"><a name="**ncbi_pgap注释流程**:" href="#**ncbi_pgap注释流程**:"></a><strong>NCBI_PGAP注释流程</strong>:</h4><p>   NCBI开发了一种新的基因组注释方法，该方法将基于<strong>比对的方法</strong>与直接从序列中预测蛋白质编码和RNA基因以及其他功能元件的方法相结合。PGAP通过将开放阅读框（ORF）与蛋白质隐马尔可夫模型（HMM），代表性RefSeq蛋白质和特征明确的参考基因组蛋白质的文库进行比较来确定结构注释。然后，GeneMarkS-2 +对缺少HMM或蛋白质证据的基因组区域进行从头算编码区域预测，并为证据来自HMM的ORF选择起始位点。</p><p>   但是这个注释通道是针对提交基因组时选择的注释方法，<strong>不对外开放使用</strong><br>   网址：<a href="https://www.ncbi.nlm.nih.gov/genome/annotation_prok/">https://www.ncbi.nlm.nih.gov/genome/annotation_prok/</a></p><center><img src="md_fig/NCBI_PGAP%E6%B3%A8%E9%87%8A%E6%B5%81%E7%A8%8B2.png" style="zoom:50%"></center><font color="black"><center>NCBI_PGAP注释流程</center></font><h4 id="**patric在线注释系统**："><a name="**patric在线注释系统**：" href="#**patric在线注释系统**："></a><strong>PATRIC在线注释系统</strong>：</h4><p>   PATRIC 基因组注释服务使用 <code>RAST</code> 工具套件RASTtk来提供基因组特征的注释。单击“注释”按钮开始注释过程后，基因组将作为“任务”排队供注释服务处理，并将在页面右下角的“任务”信息框中增加计数。注释作业成功完成后，输出文件将出现在工作空间中，可在PATRIC比较工具中使用，并在需要时下载。相对于RAST 而言数据库资源是PATRIC一大优势。</p><p>   网址：<a href="https://www.patricbrc.org/">https://www.patricbrc.org/</a></p><center><img src="md_fig/patric%E7%BD%91%E9%A1%B5%E6%B3%A8%E9%87%8A.png" style="zoom:80%"></center><font color="black"><center>patric网页注释</center></font><h4 id="**genix-在线注释**："><a name="**genix-在线注释**：" href="#**genix-在线注释**："></a><strong>Genix 在线注释</strong>：</h4><p>   Genix 细菌基因组在线自动化注释流程。Genix 流程根据提供的序列以及物种分类信息可以很方便的获得基因组注释信息，如果提供一些额外数据库提交信息，更是可以直接生成可提交的Genbank文件，对于服务器负荷来讲，和所有的在线服务一样，需要排队，一个一个来。Genix 主要是以下工具： 蛋白质编码基因预测 Prodigal；tRNA 基因预测 tRNAscan-SE；rRNA基因预测 RNAmmer；tmRNA基因预测 Aragorn；ncRNA预测 blastn + infernal + Rfam；数据可视化 JBrowse 基因组浏览器。</p><p>   Genix会根据提供的物种 taxonomy 信息（NCBI Taxonomy 标识符） 自动下载Uniprot序列库，并使用 CD-HIT 对序列做冗余过滤，减小参考数据库的大小 如果物种未知怎么办，设置细菌的NCBI Taxonomy</p><p>   网址： <a href="http://labbioinfo.ufpel.edu.br/cgi-bin/genix_registration.py">http://labbioinfo.ufpel.edu.br/cgi-bin/genix_registration.py</a> </p><center><img src="md_fig/%E5%9C%A8%E7%BA%BF%E6%B3%A8%E9%87%8A%E2%80%94GENIX%E6%8F%90%E4%BA%A4%E9%A1%B5%E9%9D%A2.png" style="zoom:70%"></center><font color="black"><center>初始化conda选择</center></font><h4 id="本地注释工具"><a name="本地注释工具" href="#本地注释工具"></a>本地注释工具</h4><h5 id="prokka"><a name="prokka" href="#prokka"></a>prokka</h5><p>    <strong>prokka</strong> 是一种命令行软件工具，可以在任何Unix系统上安装。Prokka集成了一套现有的软件工具，以实现对基因组细菌序列的丰富而可靠的注释。可以利用多个CPU，一个典型的细菌基因组，在四核台式机上约10分钟内即可注释完成。</p><p>    软件主页：<a href="http://www.vicbioinformatics.com/software.prokka.shtml">http://www.vicbioinformatics.com/software.prokka.shtml</a></p><center><img src="md_fig/prokka.big.jpg" style="zoom:70%"></center><p>   prokka 能够输出完备的注释结果,所有预测注释出的基因（CDS、 rRNA、 tRNA、tmRNA、misc_RNA）的核苷酸序列FASTA格式文件。CDS编码的蛋白质序列FASTA格式文件，Genbank格式的综合注释文件，用于提交到Genbank的ASN1格式的Sequin文件等。</p><p>   最主要的是该软件是本地运行版，结合命令行脚本能够较方便的实现大批量的自动化基因组注释。</p><h6 id="**-prokka-安装使用**"><a name="**-prokka-安装使用**" href="#**-prokka-安装使用**"></a><strong> prokka 安装使用</strong></h6><p>prokka github 主页：<a href="https://github.com/tseemann/prokka">https://github.com/tseemann/prokka</a></p><p>使用conda 安装：</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>#激活生信环境 bioinfo
source ~/anaconda3/bin/activate bioinfo

#安装prokka 上面已经安装了
conda install  -y  prokka
</code></pre>"><span class="hljs-comment">#激活生信环境 bioinfo</span>
<span class="hljs-built_in">source</span> ~/anaconda3/bin/activate bioinfo

<span class="hljs-comment">#安装prokka 上面已经安装了</span>
conda install  -y  prokka
</code></pre><center><img src="md_fig/%E6%BF%80%E6%B4%BBbioinfo%E5%AE%89%E8%A3%85prokka.png" style="zoom:80%"></center><font color="black"><center>激活bioinfo安装prokka</center></font><p><strong>prokka 介绍</strong>：<br>   <strong>Input</strong><br>   Prokka要求以FASTA格式的预组装基因组DNA序列为输入文件。典型的输入将是由de novo组装软件产生的一组支架序列，是必需参数。</p><p>   <strong>Annotation</strong><br>   Prokka依靠外部特征预测工具来识别重叠群中基因组特征的坐标。 表1中列出了这些工具，除Prodigal之外，所有工具均提供了坐标和适当的标签来描述功能。</p><font color="black"><center>表1 Prokka使用的功能预测工具</center></font><center><img src="md_fig/t1.png" style="zoom:100%"></center><p>   蛋白质编码基因注释分为两个阶段。<strong>Prodigal</strong> 鉴定候选基因的坐标，但没有描述推定的基因产物。预测基因编码的传统方法是将其与已知序列的大型数据库（通常在蛋白质序列水平上）进行比较，并转移最佳匹配的注释。</p><p>   Prokka使用此方法，但以分层方式使用，从较小的可信任数据库开始，移至中等大小但特定领域的数据库，最后移至蛋白质家族的精选模型。默认情况下，以下一系列包含的数据库使用<strong>e值阈值10-6</strong>：</p><p>   用户提供的可选的带注释的蛋白质集。预计这些将是值得信赖的精选数据集，并将用作注释的主要来源。使用<strong>BLAST+ blastp</strong>搜索（Camacho等，2009）。</p><p>   <strong>UniProt</strong> 中的所有细菌蛋白（Apweiler等人，2004）均具有真实的蛋白或转录本证据，并且不是片段。这是约16000种蛋白质，通常在大多数基因组中覆盖 <strong>&gt; 50％的核心基因</strong>。 使用BLAST +搜索。</p><p>   一系列隐马尔可夫模型表征的基因家族数据库，包括 <strong>Pfam</strong>（Punta等，2012）和 <strong>TIGRFAM</strong>（Haft等，2013）。这是使用<strong>HMMER 3.1</strong>软件包中的 <strong>hmmscan</strong>（Eddy，2011年）执行的。</p><p>   如果找不到匹配项，请标记为“<strong>假设蛋白</strong>”。</p><p>   <strong>Output</strong></p><p>软件生成10个输出文件，采用扩展名区别。</p><font color="black"><center>表2. 输出结果介绍</center></font><center><img src="md_fig/t2.png" style="zoom:100%"></center><h6 id="**一个prokka基因组注释实例**"><a name="**一个prokka基因组注释实例**" href="#**一个prokka基因组注释实例**"></a><strong>一个prokka基因组注释实例</strong></h6><p>   要想注释fasta文件，最简单的方式，不填加任何参数就可以获得。</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>#确保已经激活了 bioinfo环境 
prokka ./fasta_example_genomic.fna 
#./fasta_example_genomic.fna 为需要注释的基因组文件（fasta格式）的路径
#
</code></pre>"><span class="hljs-comment">#确保已经激活了 bioinfo环境 </span>
prokka ./fasta_example_genomic.fna 
<span class="hljs-comment">#./fasta_example_genomic.fna 为需要注释的基因组文件（fasta格式）的路径</span>
<span class="hljs-comment">#</span>
</code></pre><center><img src="md_fig/prokka%E5%AE%9E%E4%BE%8B1.png" style="zoom:100%"></center><p>   所有的结果默认存储位置是名称为<code>PROKKA_+日期</code>的文件夹：</p><center><img src="md_fig/prokka%E5%AE%9E%E4%BE%8B2.png" style="zoom:100%"></center><font color="black"><center>prokka默认运行结果存储</center></font><p>   如果需要比较完整的进行序列注释，结果可以比较方便的用来提交的话，可以添加相应的参数来规范注释以及调用不同的工具扫描ncRNA等。</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;># 注释 Escherichia coli  标准株 K-12
# 命令行中 &quot;\&quot; 在一行的末尾表示该命令没有完成 回车可在下一行继续输入后续命令语句 ，即一个命令分行显示
prokka --outdir K-12 --prefix K-12 --locustag K_12 \
--addgenes --addmrna --compliant --centre CDC \
--genus Escherichia --species &quot;Escherichia coli&quot; --strain K-12 \
--kingdom Bacteria --usegenus --cpus 4 --rfam --rnammer --force ./fasta_example_genomic.fna
</code></pre>"><span class="hljs-comment"># 注释 Escherichia coli  标准株 K-12</span>
<span class="hljs-comment"># 命令行中 "\" 在一行的末尾表示该命令没有完成 回车可在下一行继续输入后续命令语句 ，即一个命令分行显示</span>
prokka --outdir K-<span class="hljs-number">12</span> --prefix K-<span class="hljs-number">12</span> --locustag K_12 \
--addgenes --addmrna --compliant --centre CDC \
--genus Escherichia --species <span class="hljs-string">"Escherichia coli"</span> --strain K-<span class="hljs-number">12</span> \
--kingdom Bacteria --usegenus --cpus <span class="hljs-number">4</span> --rfam --rnammer --force ./fasta_example_genomic.fna
</code></pre><p>查看重要的结果文件</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>#cd 进入结果文件目录
cd K-12
#less 逐个查看文件
less K-12.gbk
less K-12.faa
less K-12.ffn
less K-12.tsv
</code></pre>"><span class="hljs-comment">#cd 进入结果文件目录</span>
<span class="hljs-built_in">cd</span> K-<span class="hljs-number">12</span>
<span class="hljs-comment">#less 逐个查看文件</span>
less K-<span class="hljs-number">12</span>.gbk
less K-<span class="hljs-number">12</span>.faa
less K-<span class="hljs-number">12</span>.ffn
less K-<span class="hljs-number">12</span>.tsv
</code></pre><p>如下：</p><pre><code data-origin="<pre><code># genbank 格式文件 *.gbk

LOCUS       K_12_1               4641652 bp    DNA     linear       10-OCT-2020
DEFINITION  Escherichia escherichia coli strain K-12.
ACCESSION
VERSION
KEYWORDS    .
SOURCE      Escherichia escherichia coli
  ORGANISM  Escherichia escherichia coli
            Unclassified.
COMMENT     Annotated using prokka 1.14.6 from
            https://github.com/tseemann/prokka.
FEATURES             Location/Qualifiers
     source          1..4641652
                     /organism=&quot;Escherichia escherichia coli&quot;
                     /mol_type=&quot;genomic DNA&quot;
                     /strain=&quot;K-12&quot;
     gene            191..310
                     /locus_tag=&quot;K_12_00001&quot;
     mRNA            191..310
                     /locus_tag=&quot;K_12_00001&quot;
                     /product=&quot;hypothetical protein&quot;
     misc_RNA        191..310
                     /locus_tag=&quot;K_12_00001&quot;
                     /product=&quot;Thr_leader&quot;
                     /inference=&quot;COORDINATES:profile:Infernal:001001&quot;
     gene            337..2799
                     /gene=&quot;thrA&quot;
                     /locus_tag=&quot;K_12_00002&quot;
     mRNA            337..2799
                     /gene=&quot;thrA&quot;
                     /locus_tag=&quot;K_12_00002&quot;
                     /product=&quot;hypothetical protein&quot;
     CDS             337..2799
                     /gene=&quot;thrA&quot;
                     /locus_tag=&quot;K_12_00002&quot;
                     /EC_number=&quot;2.7.2.4&quot;
                     /inference=&quot;ab initio prediction:Prodigal:002006&quot;
                     /inference=&quot;similar to AA
                     sequence:RefSeq:ASPKINIHOMOSERDEHYDROGI-MONOMER&quot;
                     /codon_start=1
                     /transl_table=11
                     /product=&quot;aspartate kinase / homoserine dehydrogenase&quot;
                     /protein_id=&quot;CDC:K_12_00002&quot;
                     /translation=&quot;MRVLKFGGTSVANAERFLRVADILESNARQGQVATVLSAPAKIT
                     ...

#蛋白序列文件 *.faa

&amp;gt;K_12_00002 aspartate kinase / homoserine dehydrogenase
MRVLKFGGTSVANAERFLRVADILESNARQGQVATVLSAPAKITNHLVAMIEKTISGQDA
LPNISDAERIFAELLTGLAAAQPGFPLAQLKTFVDQEFAQIKHVLHGISLLGQCPDSINA
ALICRGEKMSIAIMAGVLEARGHNVTVIDPVEKLLAVGHYLESTVDIAESTRRIAASRIP
ADHMVLMAGFTAGNEKGELVVLGRNGSDYSAAVLAACLRADCCEIWTDVDGVYTCDPRQV
PDARLLKSMSYQEAMELSYFGAKVLHPRTITPIAQFQIPCLIKNTGNPQAPGTLIGASRD
EDELPVKGISNLNNMAMFSVSGPGMKGMVGMAARVFAAMSRARISVVLITQSSSEYSISF
CVPQSDCVRAERAMQEEFYLELKEGLLEPLAVTERLAIISVVGDGMRTLRGISAKFFAAL
ARANINIVAIAQGSSERSISVVVNNDDATTGVRVTHQMLFNTDQVIEVFVIGVGGVGGAL
LEQLKRQQSWLKNKHIDLRVCGVANSKALLTNVHGLNLENWQEELAQAKEPFNLGRLIRL
VKEYHLLNPVIVDCTSSQAVADQYADFLREGFHVVTPNKKANTSSMDYYHQLRYAAEKSR
RKFLYDTNVGAGLPVIENLQNLLNAGDELMKFSGILSGSLSYIFGKLDEGMSFSEATTLA
REMGYTEPDPRDDLSGMDVARKLLILARETGRELELADIEIEPVLPAEFNAEGDVAAFMA
NLSQLDDLFAARVAKARDEGKVLRYVGNIDEDGVCRVKIAEVDGNDPLFKVKNGENALAF
YSHYYQPLPLVLRGYGAGNDVTAAGVFADLLRTLSWKLGV
&amp;gt;K_12_00003 homoserine kinase
MVKVYAPASSANMSVGFDVLGAAVTPVDGALLGDVVTVEAAETFSLNNLGRFADKLPSEP
RENIVYQCWERFCQELGKQIPVAMTLEKNMPIGSGLGSSACSVVAALMAMNEHCGKPLND
TRLLALMGELEGRISGSIHYDNVAPCFLGGMQLMIEENDIISQQVPGFDEWLWVLAYPGI
KVSTAEARAILPAQYRRQDCIAHGRHLAGFIHACYSRQPELAAKLMKDVIAEPYRERLLP
GFRQARQAVAEIGAVASGISGSGPTLFALCDKPETAQRVADWLGKNYLQNQEGFVHICRL
DTAGARVLEN
...

#基因序列文件 *.ffn

&amp;gt;K_12_00001 Thr_leader
TGAAACGCATTAGCACCACCATTACCACCACCATCACCATTACCACAGGTAACGGTGCGG
GCTGACGCGTACAGGAAACACAGAAAAAAGCCCGCACCTGACAGTGCGGGCTTTTTTTTT
&amp;gt;K_12_00002 aspartate kinase / homoserine dehydrogenase
ATGCGAGTGTTGAAGTTCGGCGGTACATCAGTGGCAAATGCAGAACGTTTTCTGCGTGTT
GCCGATATTCTGGAAAGCAATGCCAGGCAGGGGCAGGTGGCCACCGTCCTCTCTGCCCCC
GCCAAAATCACCAACCACCTGGTGGCGATGATTGAAAAAACCATTAGCGGCCAGGATGCT
TTACCCAATATCAGCGATGCCGAACGTATTTTTGCCGAACTTTTGACGGGACTCGCCGCC
GCCCAGCCGGGGTTCCCGCTGGCGCAATTGAAAACTTTCGTCGATCAGGAATTTGCCCAA
ATAAAACATGTCCTGCATGGCATTAGTTTGTTGGGGCAGTGCCCGGATAGCATCAACGCT
GCGCTGATTTGCCGTGGCGAGAAAATGTCGATCGCCATTATGGCCGGCGTATTAGAAGCG
CGCGGTCACAACGTTACTGTTATCGATCCGGTCGAAAAACTGCTGGCAGTGGGGCATTAC
CTCGAATCTACCGTCGATATTGCTGAGTCCACCCGCCGTATTGCGGCAAGCCGCATTCCG
GCTGATCACATGGTGCTGATGGCAGGTTTCACCGCCGGTAATGAAAAAGGCGAACTGGTG
GTGCTTGGACGCAACGGTTCCGACTACTCTGCTGCGGTGCTGGCTGCCTGTTTACGCGCC
GATTGTTGCGAGATTTGGACGGACGTTGACGGGGTCTATACCTGCGACCCGCGTCAGGTG
...

# 表格型注释文件 *.tsv

locus_tag       ftype   length_bp       gene    EC_number       COG     product
K_12_00001      gene    120
K_12_00001      mRNA    120
K_12_00001      misc_RNA        120                             Thr_leader
K_12_00002      gene    2463    thrA
K_12_00002      mRNA    2463    thrA
K_12_00002      CDS     2463    thrA    2.7.2.4         aspartate kinase / homoserine dehydrogenase
K_12_00003      gene    933     thrB
...
</code></pre>"># genbank 格式文件 *.gbk

LOCUS       K_12_1               4641652 bp    DNA     linear       10-OCT-2020
DEFINITION  Escherichia escherichia coli strain K-12.
ACCESSION
VERSION
KEYWORDS    .
SOURCE      Escherichia escherichia coli
  ORGANISM  Escherichia escherichia coli
            Unclassified.
COMMENT     Annotated using prokka 1.14.6 from
            https://github.com/tseemann/prokka.
FEATURES             Location/Qualifiers
     source          1..4641652
                     /organism="Escherichia escherichia coli"
                     /mol_type="genomic DNA"
                     /strain="K-12"
     gene            191..310
                     /locus_tag="K_12_00001"
     mRNA            191..310
                     /locus_tag="K_12_00001"
                     /product="hypothetical protein"
     misc_RNA        191..310
                     /locus_tag="K_12_00001"
                     /product="Thr_leader"
                     /inference="COORDINATES:profile:Infernal:001001"
     gene            337..2799
                     /gene="thrA"
                     /locus_tag="K_12_00002"
     mRNA            337..2799
                     /gene="thrA"
                     /locus_tag="K_12_00002"
                     /product="hypothetical protein"
     CDS             337..2799
                     /gene="thrA"
                     /locus_tag="K_12_00002"
                     /EC_number="2.7.2.4"
                     /inference="ab initio prediction:Prodigal:002006"
                     /inference="similar to AA
                     sequence:RefSeq:ASPKINIHOMOSERDEHYDROGI-MONOMER"
                     /codon_start=1
                     /transl_table=11
                     /product="aspartate kinase / homoserine dehydrogenase"
                     /protein_id="CDC:K_12_00002"
                     /translation="MRVLKFGGTSVANAERFLRVADILESNARQGQVATVLSAPAKIT
                     ...

#蛋白序列文件 *.faa

&gt;K_12_00002 aspartate kinase / homoserine dehydrogenase
MRVLKFGGTSVANAERFLRVADILESNARQGQVATVLSAPAKITNHLVAMIEKTISGQDA
LPNISDAERIFAELLTGLAAAQPGFPLAQLKTFVDQEFAQIKHVLHGISLLGQCPDSINA
ALICRGEKMSIAIMAGVLEARGHNVTVIDPVEKLLAVGHYLESTVDIAESTRRIAASRIP
ADHMVLMAGFTAGNEKGELVVLGRNGSDYSAAVLAACLRADCCEIWTDVDGVYTCDPRQV
PDARLLKSMSYQEAMELSYFGAKVLHPRTITPIAQFQIPCLIKNTGNPQAPGTLIGASRD
EDELPVKGISNLNNMAMFSVSGPGMKGMVGMAARVFAAMSRARISVVLITQSSSEYSISF
CVPQSDCVRAERAMQEEFYLELKEGLLEPLAVTERLAIISVVGDGMRTLRGISAKFFAAL
ARANINIVAIAQGSSERSISVVVNNDDATTGVRVTHQMLFNTDQVIEVFVIGVGGVGGAL
LEQLKRQQSWLKNKHIDLRVCGVANSKALLTNVHGLNLENWQEELAQAKEPFNLGRLIRL
VKEYHLLNPVIVDCTSSQAVADQYADFLREGFHVVTPNKKANTSSMDYYHQLRYAAEKSR
RKFLYDTNVGAGLPVIENLQNLLNAGDELMKFSGILSGSLSYIFGKLDEGMSFSEATTLA
REMGYTEPDPRDDLSGMDVARKLLILARETGRELELADIEIEPVLPAEFNAEGDVAAFMA
NLSQLDDLFAARVAKARDEGKVLRYVGNIDEDGVCRVKIAEVDGNDPLFKVKNGENALAF
YSHYYQPLPLVLRGYGAGNDVTAAGVFADLLRTLSWKLGV
&gt;K_12_00003 homoserine kinase
MVKVYAPASSANMSVGFDVLGAAVTPVDGALLGDVVTVEAAETFSLNNLGRFADKLPSEP
RENIVYQCWERFCQELGKQIPVAMTLEKNMPIGSGLGSSACSVVAALMAMNEHCGKPLND
TRLLALMGELEGRISGSIHYDNVAPCFLGGMQLMIEENDIISQQVPGFDEWLWVLAYPGI
KVSTAEARAILPAQYRRQDCIAHGRHLAGFIHACYSRQPELAAKLMKDVIAEPYRERLLP
GFRQARQAVAEIGAVASGISGSGPTLFALCDKPETAQRVADWLGKNYLQNQEGFVHICRL
DTAGARVLEN
...

#基因序列文件 *.ffn

&gt;K_12_00001 Thr_leader
TGAAACGCATTAGCACCACCATTACCACCACCATCACCATTACCACAGGTAACGGTGCGG
GCTGACGCGTACAGGAAACACAGAAAAAAGCCCGCACCTGACAGTGCGGGCTTTTTTTTT
&gt;K_12_00002 aspartate kinase / homoserine dehydrogenase
ATGCGAGTGTTGAAGTTCGGCGGTACATCAGTGGCAAATGCAGAACGTTTTCTGCGTGTT
GCCGATATTCTGGAAAGCAATGCCAGGCAGGGGCAGGTGGCCACCGTCCTCTCTGCCCCC
GCCAAAATCACCAACCACCTGGTGGCGATGATTGAAAAAACCATTAGCGGCCAGGATGCT
TTACCCAATATCAGCGATGCCGAACGTATTTTTGCCGAACTTTTGACGGGACTCGCCGCC
GCCCAGCCGGGGTTCCCGCTGGCGCAATTGAAAACTTTCGTCGATCAGGAATTTGCCCAA
ATAAAACATGTCCTGCATGGCATTAGTTTGTTGGGGCAGTGCCCGGATAGCATCAACGCT
GCGCTGATTTGCCGTGGCGAGAAAATGTCGATCGCCATTATGGCCGGCGTATTAGAAGCG
CGCGGTCACAACGTTACTGTTATCGATCCGGTCGAAAAACTGCTGGCAGTGGGGCATTAC
CTCGAATCTACCGTCGATATTGCTGAGTCCACCCGCCGTATTGCGGCAAGCCGCATTCCG
GCTGATCACATGGTGCTGATGGCAGGTTTCACCGCCGGTAATGAAAAAGGCGAACTGGTG
GTGCTTGGACGCAACGGTTCCGACTACTCTGCTGCGGTGCTGGCTGCCTGTTTACGCGCC
GATTGTTGCGAGATTTGGACGGACGTTGACGGGGTCTATACCTGCGACCCGCGTCAGGTG
...

# 表格型注释文件 *.tsv

locus_tag       ftype   length_bp       gene    EC_number       COG     product
K_12_00001      gene    120
K_12_00001      mRNA    120
K_12_00001      misc_RNA        120                             Thr_leader
K_12_00002      gene    2463    thrA
K_12_00002      mRNA    2463    thrA
K_12_00002      CDS     2463    thrA    2.7.2.4         aspartate kinase / homoserine dehydrogenase
K_12_00003      gene    933     thrB
...
</code></pre><p><code>--kingdom</code> 参数<br>默认注释的是细菌基因组，如果是其他物种则要添加这个参数。可选项有：<br>Archaea<br>Bacteria<br>Mitochondria（线粒体）<br>Viruses<br>比如要注释病毒基因组：</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>prokka --kingdom Viruses contigs.fasta
</code></pre>">prokka --kingdom Viruses contigs.fasta
</code></pre><h5 id="使用eggnog-mapper进行功能注释"><a name="使用eggnog-mapper进行功能注释" href="#使用eggnog-mapper进行功能注释"></a>使用eggnog-mapper进行功能注释</h5><p>   <strong>eggnog-mapper</strong> 软件运行的原理：（1）程序调用HMMER算法将query序列比对到HMM数据库，得到匹配上的OGs结果。然后将query序列和最优OG中的所有蛋白序列进行比对，得到最优匹配序列（seed ortholog）结果。（2）也可以选择DIAMOND算法将query序列比对到蛋白序列数据库，得到比对结果，选择最优的比对结果作为seed ortholog。（3）基于eggNOG数据库中的对应OG的系统发育树，根据seed ortholog能得到详细的同源基因进化关系，从而剔除亲缘关系较远的直系同源基因，甚至可以剔除一对多的同源基因而仅保留一对一的直系同源基因，将最准确的同源基因的功能注释结果转移给query序列，从而对query序列进行功能注释。<br>   官方提供在线注释服务，（ <a href="http://eggnog-mapper.embl.de/">http://eggnog-mapper.embl.de/</a> ） 推荐使用网页工具进行eggNOG注释，简单方便，结果认可度高。以下情况推荐使用官方提供的软件eggnog-mapper进行<strong>本地化注释</strong>：</p><ul>
<li>注释的数据量过大，比如宏基因组数据；</li><li>使用更准确的HMMER算法一次性注释超过5000条序列；</li><li>想更快地进行eggNOG注释；</li><li>网络条件较差。</li></ul><h6 id="eggnog-mapper安装"><a name="eggnog-mapper安装" href="#eggnog-mapper安装"></a>eggnog-mapper安装</h6><p>这里使用conda 创建一个名为 eggnogmapper 的虚拟环境并安装eggnog-mapper</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>source ~/anaconda3/bin/activate
# conda search 搜索 eggnog-mapper 的版本
#conda search eggnog
#创建并安装 eggnogmapper -c 指定 下载通道
conda create -y -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/  \
-n eggnogmapper eggnog-mapper
</code></pre>"><span class="hljs-built_in">source</span> ~/anaconda3/bin/activate
<span class="hljs-comment"># conda search 搜索 eggnog-mapper 的版本</span>
<span class="hljs-comment">#conda search eggnog</span>
<span class="hljs-comment">#创建并安装 eggnogmapper -c 指定 下载通道</span>
conda create -y -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/  \
-n eggnogmapper eggnog-mapper
</code></pre><p>安装完成后显示激活/退出 eggnogmapper 的命令:</p><pre><code data-origin="<pre><code>... ...
... ...
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
#     $ conda activate eggnogmapper
#
# To deactivate an active environment, use
#
#     $ conda deactivate
</code></pre>">... ...
... ...
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
#     $ conda activate eggnogmapper
#
# To deactivate an active environment, use
#
#     $ conda deactivate
</code></pre><p>   激活eggnogmapper 环境 下载数据库。 最新版的储存要求（19-Mar-2019），eggNOG注释数据库约为37GB，序列数据库约8.7GB；但是这是全部包含真核生物、原核、病毒等全部数据，老版本的（emapperdb-4.5.1） emapper 你可以按自己的需求下载部分数据库。新版emapper-2.0.1 相对少一些数据，但必须全部下载。建议专门使用一个空间足够的硬盘位置建一个目录 emapper_databse, 存放数据库文件。尤其是使用的win10 子系统的一定是要找的一个空的盘符 建这个文件夹。<br>例如win10 的 <code>G:\bioinfo_course\00_Windows_Subsystem</code> 文件夹，在自系统中的位置是 <code>/mnt/g/bioinfo_course/00_Windows_Subsystem</code> 实际上 win10 的所有盘都在子系统<code>/mnt/</code> 可以 cd 查看：</p><center><img src="md_fig/%E5%AD%90%E7%B3%BB%E7%BB%9F%E4%B8%8Bwin%E7%A1%AC%E7%9B%98%E6%8C%82%E8%BD%BD%E7%82%B9.png" style="zoom:100%"></center><font color="black"><center>子系统下win硬盘挂载点</center></font><p><strong>执行下载命令</strong>：</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;># cd 到数据库目录
cd path/to/emapper_databse
# --data_dir 参数指定下载存储的位置， $PWD 表示当前目录的路径 相当于上面的 path/to/emapper_databse
download_eggnog_data.py  -y --data_dir $PWD

#此步骤下载两个压缩文件（下载时间根据网速而定）：
#    eggnog.db.gz   8GB
#    eggnog_proteins.dmnd.gz  5G
#对于网速较慢的服务器可以自行下载这两个文件然后上传拷贝到数据库存储目录：
#    http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog.db.gz
#    http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog_proteins.dmnd.gz
</code></pre>"><span class="hljs-comment"># cd 到数据库目录</span>
<span class="hljs-built_in">cd</span> path/to/emapper_databse
<span class="hljs-comment"># --data_dir 参数指定下载存储的位置， $PWD 表示当前目录的路径 相当于上面的 path/to/emapper_databse</span>
download_eggnog_data.py  -y --data_dir <span class="hljs-variable">$PWD</span>

<span class="hljs-comment">#此步骤下载两个压缩文件（下载时间根据网速而定）：</span>
<span class="hljs-comment">#    eggnog.db.gz   8GB</span>
<span class="hljs-comment">#    eggnog_proteins.dmnd.gz  5G</span>
<span class="hljs-comment">#对于网速较慢的服务器可以自行下载这两个文件然后上传拷贝到数据库存储目录：</span>
<span class="hljs-comment">#    http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog.db.gz</span>
<span class="hljs-comment">#    http://eggnog5.embl.de/download/emapperdb-5.0.0/eggnog_proteins.dmnd.gz</span>
</code></pre><center><img src="md_fig/eggnog%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8B%E8%BD%BD.png" style="zoom:100%"></center><font color="black"><center>eggnog数据库下载</center></font><p>使用emapper注释蛋白序列，我是用 diamond 作为比对软件，使用20个 cpu 并行计算，注释了 2302条序列，使用时间为<code>963.732s</code></p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;># emapper.py --data_dir --database [euk,bact,arch, host:port ] -m {hmmer,diamond}  --cpu 20 --output_dir --output
#  --data_dir ：数据库位置 ， --database指定蛋白来源（界，kingdom） bact ，
#  -m 比对方法 diamond ， --cpu 使用最大线程数 20 ，
#  --output_dir 结果输出目录（需已存在）eggnog_out，--output 结果输出文件名  -i 指定输入蛋白文件 test.faa

emapper.py --data_dir /pub/biodatabase/eggnog_5.0/database/  --database bact -m diamond  --cpu 20 \
--output_dir eggnog_out  --output eggnog_result -i test.faa
</code></pre>"><span class="hljs-comment"># emapper.py --data_dir --database [euk,bact,arch, host:port ] -m {hmmer,diamond}  --cpu 20 --output_dir --output</span>
<span class="hljs-comment">#  --data_dir ：数据库位置 ， --database指定蛋白来源（界，kingdom） bact ，</span>
<span class="hljs-comment">#  -m 比对方法 diamond ， --cpu 使用最大线程数 20 ，</span>
<span class="hljs-comment">#  --output_dir 结果输出目录（需已存在）eggnog_out，--output 结果输出文件名  -i 指定输入蛋白文件 test.faa</span>

emapper.py --data_dir /pub/biodatabase/eggnog_5.<span class="hljs-number">0</span>/database/  --database bact -m diamond  --cpu <span class="hljs-number">20</span> \
--output_dir eggnog_out  --output eggnog_result -i test.faa
</code></pre><p>输出结果为有两个文件（diamond比对模式）：</p><ul>
<li><p>[out_name].emapper.annotations    最终的注释结果。文本格式的表格，一共有22列，可以使用脚本，提取对应注释信息 </p>
<ul>
<li>每一列对应如下：</li></ul>
<pre><code data-origin="<pre><code>1. query_name            检索的ID
2. seed_eggNOG_ortholog    eggNOG中最佳的蛋白匹配
3. seed_ortholog_evalue    最佳匹配的e-value
4. seed_ortholog_score    最佳匹配的bit-score
5. best_tax_level    预测的物种
6. Preferred_name    预测的蛋白名称
7. GOs                GO条目
8. EC                酶学编号
9. KEGG_ko            预测的KEGG KO词条
10. KEGG_Pathway    预测的KEGG Pathway
11. KEGG_Module        预测的KEGG 功能单元
12. KEGG_Reaction    预测的KEGG 酶促反应
13. KEGG_rclass        预测的KEGG 酶促反应类型
14. BRITE            预测的KEGG功能分类信息
15. KEGG_TC            预测的KEGG的一类功能信息（我也不知道是啥）
16. CAZy            CAZy 碳水化合物酶编号
17. BiGG_Reaction     BiGG代谢反应的预测结果
18. taxonomic scope        对该序列在分类学的注释
19. eggNOG OGs        匹配的eggNOG Orthologous Groups
20. best eggNOG OG    最佳匹配的OG
21. COG Functional cat.     最佳匹配的OG的COG功能分类
22. eggNOG free text desc.    最佳匹配的OG的eggNOG功能描述
</code></pre>">1. query_name            检索的ID
2. seed_eggNOG_ortholog    eggNOG中最佳的蛋白匹配
3. seed_ortholog_evalue    最佳匹配的e-value
4. seed_ortholog_score    最佳匹配的bit-score
5. best_tax_level    预测的物种
6. Preferred_name    预测的蛋白名称
7. GOs                GO条目
8. EC                酶学编号
9. KEGG_ko            预测的KEGG KO词条
10. KEGG_Pathway    预测的KEGG Pathway
11. KEGG_Module        预测的KEGG 功能单元
12. KEGG_Reaction    预测的KEGG 酶促反应
13. KEGG_rclass        预测的KEGG 酶促反应类型
14. BRITE            预测的KEGG功能分类信息
15. KEGG_TC            预测的KEGG的一类功能信息（我也不知道是啥）
16. CAZy            CAZy 碳水化合物酶编号
17. BiGG_Reaction     BiGG代谢反应的预测结果
18. taxonomic scope        对该序列在分类学的注释
19. eggNOG OGs        匹配的eggNOG Orthologous Groups
20. best eggNOG OG    最佳匹配的OG
21. COG Functional cat.     最佳匹配的OG的COG功能分类
22. eggNOG free text desc.    最佳匹配的OG的eggNOG功能描述
</code></pre></li><li>[out_name].emapper.seed_orthologs    <ul>
<li>检索蛋白序列对应的 同源物ID 和比对分数</li></ul>
</li></ul><p>   上述结果文件基本包含了基因组注释的几大数据库结果，一般来讲后续的分析只需要从中提取信息就可以了。</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
